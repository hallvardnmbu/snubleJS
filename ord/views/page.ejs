<!doctype html>
<html lang="nb">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Dagens ord</title>
        <link rel="stylesheet" href="/style.css" />
    </head>
    <body>
        <header>
          <% if (day && week && date) { %>
            <div><%= day.charAt(0).toUpperCase() + day.slice(1) %></div>
            <div>•</div>
            <div>Uke <%= week %></div>
            <div>•</div>
            <div><%= date %></div>
          <% } else if (day) { %>
            <div>Søkte etter <b><%= day %></b>.</div>
          <% } else { %>
            <div></div>
          <% } %>
        </header>

        <main id="words">
            <% if (words && words.length > 0) { %>
                <% words.forEach(function(item) { %>

                  <% if (day && week && date) { %>
                    <div class="heading">Dagens ord: <b><%= item.word %></b>.</div>
                  <% } else if (day) { %>
                    <div class="heading">Fant ord: <b><%= item.word %></b>.</div>
                  <% } else { %>
                    <div class="heading">Tilfeldig ord: <b><%= item.word %></b>.</div>
                  <% } %>

                    <section>
                      <a href="https://ordbokene.no/nob/bm/<%= item.id %>" class="top" target="_blank">
                        <div class="word"><%= item.word %></div>
                        <div class="group"><%= item.group %></div>
                      </a>

                        <% if (item.etymology) { %>
                          <% item.etymology.forEach(function(etymology) { %>
                              <% if (etymology.text) { %>
                                  <div class="etymology">
                                      <%= etymology.text %>
                                  </div>
                              <% } %>
                          <% }); %>
                        <% } %>

                        <hr />

                        <% if (item.definitions) { %>
                          <% Object.entries(item.definitions).forEach(([type, elements]) => { %>
                              <div class="definition"><b><%= type %></b></div>
                              <% elements.forEach(element => { %>
                                <div class="definition"><%= element %></div>
                              <% }); %>
                          <% }); %>
                        <% } %>

                        <button id="toggleInflection" onclick="toggleInflection()">
                          hallo, hvordan bøyes det?
                        </button>

                        <script>
                        function toggleInflection() {
                            const button = document.getElementById('toggleInflection');
                            button.textContent = button.textContent.trim() === 'hallo, hvordan bøyes det?' ? 'jaja ok, jeg forstår' : 'hallo, hvordan bøyes det?';
                            const inflections = document.querySelectorAll('.inflection');
                            inflections.forEach((inflection) => {
                                inflection.style.display = inflection.style.display === 'table' ? 'none' : 'table';
                            });
                        }
                        </script>

                        <% if (item.lemmas && item.lemmas[0]) { %>
                            <% if (item.lemmas[0].inflection) { %>
                                <table class="inflection" style="display: none;">
                                    <tbody>
                                        <% item.lemmas[0].inflection.inflections.slice(0, 5).forEach(function(inflect) { %>
                                            <% if (inflect.word_form) { %>
                                                <tr>
                                                    <td class="word-cell"><%= inflect.word_form %></td>
                                                    <td class="form-cell"><%= inflect.tags ? inflect.tags.join(' ') : '' %></td>
                                                </tr>
                                            <% } %>
                                        <% }); %>
                                    </tbody>
                                </table>
                            <% } %>

                        <% } %>

                    </section>
                <% }); %>
            <% } else if (error) { %>
                <section>
                    <div class="heading">Noe gikk galt: <%= error %></div>
                </section>
            <% } else { %>
                <section>
                  <div class="heading">Fant ikke dette ordet i databasen.</div>
                </section>
            <% } %>
        </main>

        <div class="find">
          <form action="/" method="get">
            <button type="submit">dagens ord</button>
          </form>

          <form action="/search" method="get">
            <input type="text" name="word" placeholder="ord" />
            <button type="submit">søk</button>
          </form>

          <form action="/random" method="get">
            <button type="submit">tilfeldig</button>
          </form>
        </div>

        <footer>
          <div class="copyright">
              (C)
              <div class="names">
                  <div><a href="https://dilettant.no" target="_blank" style="color: var(--black)">Hallvard H. Lavik</a></div>
              </div>
          </div>
          <a href="https://github.com/hallvardnmbu/ord" target="_blank">Kildekode</a>
        </footer>
    </body>
</html>
